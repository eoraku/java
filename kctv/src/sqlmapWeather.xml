<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="kctv_weather">
	<typeAlias alias="int" type="java.lang.Integer"/>
	<typeAlias alias="string" type="java.lang.String"/>
	
	<typeAlias alias="national" type="kctv.web.weather.National"/>
	<typeAlias alias="areaSimple" type="kctv.web.weather.AreaSimple"/>
	
	<select id="listNational" resultClass="national">
		<![CDATA[
		(SELECT RC_NAME, WN_RAINF, SUBSTRING(WN_FORECAST, 4) WN_FORECAST, ROUND(WN_TEMP) WN_TEMP, RC_X, RC_Y, RC_ORDER
			FROM WEATHER_SIMPLE LEFT JOIN REGION_CODE ON WN_REGION = RC_CODE 
			WHERE WN_WHEN = '0' AND RC_CATEGORY = '2' AND rc_order=8)
		UNION
		(SELECT RC_NAME, WN_RAINF, SUBSTRING(WN_FORECAST, 4) WN_FORECAST, ROUND(WN_TEMP) WN_TEMP, RC_X, RC_Y, RC_ORDER
			FROM WEATHER_SIMPLE LEFT JOIN REGION_CODE ON WN_REGION = RC_CODE 
			WHERE WN_WHEN = '0' AND RC_CATEGORY = '2' 
			ORDER BY RC_ORDER)
		]]>
	</select>
	<select id="listAllAreaSimple" resultClass="areaSimple">
		<![CDATA[
		(SELECT rc_order, RC_NAME RD_NAME, WN_RAINF W3_PTY, SUBSTRING(WN_FORECAST, 4) W3_SKY, ROUND(WN_TEMP) WL_T1H
			FROM WEATHER_SIMPLE LEFT JOIN REGION_CODE ON WN_REGION = RC_CODE 
			WHERE WN_WHEN = '0' AND RC_CATEGORY = '2' ORDER BY RC_ORDER)
		UNION (SELECT 21 rc_order, RD_NAME, ROUND(W3_PTY) W3_PTY, ROUND(W3_SKY) W3_SKY, ROUND(WL_T1H) WL_T1H FROM WEATHER LEFT JOIN REGION_COORD ON RD_X = W3_X AND RD_Y = W3_Y LEFT JOIN WEATHER_LIVE ON WL_X = W3_X AND WL_Y = W3_Y WHERE W3_X = '48' AND W3_Y = '36' ORDER BY W3_SEQ LIMIT 1)
		UNION (SELECT 22 rc_order, RD_NAME, ROUND(W3_PTY) W3_PTY, ROUND(W3_SKY) W3_SKY, ROUND(WL_T1H) WL_T1H FROM WEATHER LEFT JOIN REGION_COORD ON RD_X = W3_X AND RD_Y = W3_Y LEFT JOIN WEATHER_LIVE ON WL_X = W3_X AND WL_Y = W3_Y WHERE W3_X = '52' AND W3_Y = '38' ORDER BY W3_SEQ LIMIT 1)
		UNION (SELECT 23 rc_order, RD_NAME, ROUND(W3_PTY) W3_PTY, ROUND(W3_SKY) W3_SKY, ROUND(WL_T1H) WL_T1H FROM WEATHER LEFT JOIN REGION_COORD ON RD_X = W3_X AND RD_Y = W3_Y LEFT JOIN WEATHER_LIVE ON WL_X = W3_X AND WL_Y = W3_Y WHERE W3_X = '59' AND W3_Y = '38' ORDER BY W3_SEQ LIMIT 1)
		UNION (SELECT 24 rc_order, RD_NAME, ROUND(W3_PTY) W3_PTY, ROUND(W3_SKY) W3_SKY, ROUND(WL_T1H) WL_T1H FROM WEATHER LEFT JOIN REGION_COORD ON RD_X = W3_X AND RD_Y = W3_Y LEFT JOIN WEATHER_LIVE ON WL_X = W3_X AND WL_Y = W3_Y WHERE W3_X = '53' AND W3_Y = '35' ORDER BY W3_SEQ LIMIT 1)
		UNION (SELECT 25 rc_order, RD_NAME, ROUND(W3_PTY) W3_PTY, ROUND(W3_SKY) W3_SKY, ROUND(WL_T1H) WL_T1H FROM WEATHER LEFT JOIN REGION_COORD ON RD_X = W3_X AND RD_Y = W3_Y LEFT JOIN WEATHER_LIVE ON WL_X = W3_X AND WL_Y = W3_Y WHERE W3_X = '48' AND W3_Y = '32' ORDER BY W3_SEQ LIMIT 1)
		UNION (SELECT 26 rc_order, RD_NAME, ROUND(W3_PTY) W3_PTY, ROUND(W3_SKY) W3_SKY, ROUND(WL_T1H) WL_T1H FROM WEATHER LEFT JOIN REGION_COORD ON RD_X = W3_X AND RD_Y = W3_Y LEFT JOIN WEATHER_LIVE ON WL_X = W3_X AND WL_Y = W3_Y WHERE W3_X = '53' AND W3_Y = '32' ORDER BY W3_SEQ LIMIT 1)
		UNION (SELECT 27 rc_order, RD_NAME, ROUND(W3_PTY) W3_PTY, ROUND(W3_SKY) W3_SKY, ROUND(WL_T1H) WL_T1H FROM WEATHER LEFT JOIN REGION_COORD ON RD_X = W3_X AND RD_Y = W3_Y LEFT JOIN WEATHER_LIVE ON WL_X = W3_X AND WL_Y = W3_Y WHERE W3_X = '58' AND W3_Y = '34' ORDER BY W3_SEQ LIMIT 1)
		ORDER BY rc_order
		]]>
	</select>
</sqlMap>